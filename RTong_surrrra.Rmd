---
title: "RTong"
author: "SuA"
date: "2022-08-12"
output: html_document
---

```{r}
library(MASS)
df<-survey
```

```{r}
df<-na.omit(df)
```

```{r}
hist(df$Age, col='tomato')   # 연령의 분포 살펴보기
```


## 일표본 t검정(양측검정)
H0 : 학생들의 평균 나이가 23살이다.  
H1 : 학생들의 평균 나이가 23살이 아니다.

```{r}
t.test(df$Age, mu=23)
```

학생들의 평균 나이는 20.4세이고,  
검정통계량 t = -5.4539이고 p-value 1.749e-07이므로 유의수준 0.05에서 귀무가설을 기각한다.  
따라서 학생들의 평균 나이가 23살이 아니라고 할 수 있다.




## 일표본 t검정(단측검정)
H0 : 학생들의 평균 나이가 21살보다 작거나 같다.  
H1 : 학생들의 평균 나이가 21살보다 크다.

```{r}
t.test(df$Age, mu=21, alternative='greater')
```
학생들의 평균 나이는 20.4세이고,  
검정통계량 t = -1.2037이고 p-value=0.8848이므로 유의수준 0.05에서 귀무가설을 기각하지 못한다.  
따라서 학생들의 평균 나이가 21살보다 작거나 같다고 할 수 있다.  


## 일표본 t검정(단측검정)
H0 : 학생들의 평균 나이가 21살보다 크거나 같다.  
H1 : 학생들의 평균 나이가 21살보다 작다.  

```{r}
t.test(df$Age, mu=21, alternative='less')
```

학생들의 평균 나이는 20.4세이고,  
검정통계량 t = -1.2037이고 p-value=0.1152이므로 유의수준 0.05에서 귀무가설을 기각한다.  
따라서 학생들의 평균 나이가 21살보다 작다고 할 수 있다.  


## 독립표본 t검정

독립표본 t검정은 두 집단 간에 평균 차이가 있는지를 검정할 때 사용.  

독립표본 t검정에서 ~ 앞에는 검정하고자 하는 종속변수 지정, ~ 뒤에는 집단을 나타내는 독립변수를 지정한다.  
또한 집단을 나타내는 독립변수는 팩터 형식이어야 한다.  

H0 : 성별에 따라서 연령에 차이가 없다.  
H1 : 성별에 따라서 연령에 차이가 있다.  

```{r}
t.test(Age~Sex, data=df)
```

검정통계량 t = -0.67983, p-value 0.4977이므로 유의수준 0.05에서 귀무가설을 기각하지 못한다.  
따라서 성별에 따라 연령에 차이가 없다.

```{r}
par(mfrow=c(1, 2))
barplot(table(df[df$Sex=='Female', 'Age']), col='tomato', main='Female')
barplot(table(df[df$Sex=='Male', 'Age']), col='skyblue', main='Male')

# 한 그래프 안에.. p.55처럼 그릴 수 있는 방법을 찾아보기
```



## 대응표본 t검정
같은 대상에게서 추출된 두 개의 데이터가 있을 때(ex : 사전-사후, 왼손-오른손) 사용  

데이터셋 : sleep  
- 10명의 실험 대상자에게 두 종류의 수면제를 복용하게 한 후 수면제를 복용했을 때의 수면시간과 복용하지 않았을때의 수면시간의 차이를 기록.  

H0 : 수면제에 따라 수면시간의 차이가 없다.  
H1 : 수면제에 따라 수면시간의 차이가 있다.  

```{r}
df<-na.omit(sleep)
```

```{r}
str(df)
```

### 집단별 평균 알아보기
```{r}
mean(df[df$group==1, ]$extra)
```

```{r}
mean(df[df$group==2, ]$extra)
```


```{r}
t.test(extra~group, data=sleep, paired=T)
```

집단1의 평균은 0.75, 집단2의 평균은 2.33으로 두 집단의 평균 차이는 -1.58이고,
검정통계량 t = -4.0621이고 p-value=0.002833이므로 유의수준 0.05에서 귀무가설을 기각한다.  
따라서 수면제에 따라 수면시간에 차이가 있다고 할 수 있다.  

### 와이드 포맷의 형태
하나의 행에 두 수면제에 대한 수면시간이 쌍을 이룬 채 나란히 기록되어 있는 경우에는 포뮬러(~)를 이용하여 인수를 지정하지 못함.  

```{r}
library(tidyr)  # spread 함수가 tidyr 안에 있음
sleep.wide<-spread(sleep, key=group, value=extra)
```

```{r}
sleep.wide
```
이런 형태가 와이드 포맷 형태.
처음에 본 sleep 데이터는 롱 포맷 형태.


```{r}
t.test(sleep.wide$`1`, sleep.wide$`2`, paired=T)
```

